/*
	$('video').each(function() {
		var videoElement = $(this)[0];
		var isBlobLoaded = false; // Flag to track if blob is loaded
		var $overlay = $('<div class="video-overlay">Loading...</div>'); // Create a loading overlay
	
		$(videoElement).prop('controls', false); // Disable video controls initially
		$(this).parent().append($overlay);
	
		var sources = $(this).find('source');
		var promises = [];
	
		sources.each(function() {
			var sourceElement = $(this)[0];
			var videoURL = $(this).attr('src');
	
			var promise = fetch(videoURL)
				.then(response => response.blob())
				.then(videoBlob => {
					var videoObjectURL = URL.createObjectURL(videoBlob);
	
					// Set the src attribute of the source element to the URL
					$(sourceElement).attr('src', videoObjectURL);
				})
				.catch(error => {
					console.error('Failed to fetch video:', error);
				});
	
			promises.push(promise);
		});
	
		Promise.all(promises)
			.then(() => {
				if (!isBlobLoaded) {
					// Call the load method on the video element to update the sources
					videoElement.load();
					isBlobLoaded = true; // Update the flag
					$(videoElement).prop('controls', true); // Enable video controls
					$overlay.remove(); // Remove the loading overlay
				}
			});
	});
	*/

	// Get all the image elements on the page
	var images = $('img');

	images.each(function(index, img) {
		var xhr = new XMLHttpRequest();
		xhr.open("GET", $(img).attr("src"), true);
		xhr.responseType = "blob";
		xhr.onload = function() {
		  if (this.status === 200) {
			var blob = this.response;
			$(img).attr("src", URL.createObjectURL(blob));
		  }
		};
		xhr.send();
	});
	// Add click event listeners to all the images
	images.click(function() {
		// Get the source of the clicked image
		var src = $(this).attr('src');

		// Create a new modal and append it to the body
		var modal = $(`<div class="modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<img class="modal-img" src="${src}">
			</div>
		</div>
	</div>`);
		modal.appendTo('body');

		// Show the modal and overlay
		modal.show();
		$('body').css('overflow', 'hidden')
		// Add a click event listener to the close button and overlay to remove the modal and overlay from the body
		modal.click(function() {
			modal.hide();
			modal.remove();
			$('body').css('overflow', 'visible')
		});

	});

	const blurDivs = $(".blur-load");
	blurDivs.each(function() {
		const img = $(this).find("img");
		const loaded = () => {
			$(this).addClass('loaded');
		};
		if (img[0].complete) {
			loaded();
		} else {
			img.on('load', loaded);
		}
	});


	/*
    function acceptedFunctionalityCookie() {
        // Your code that should run after accepting cookies goes here
        var language = Cookies.get('language');
        console.log(language);

        switch (language) {
            case 'ES':
            case 'MX':
            case 'AR':
            case 'CO':
            case 'PE':
            case 'VE':
            case 'CL':
            case 'EC':
            case 'GT':
            case 'CU':
                if (window.location.pathname != '/es') {
                    window.location.href = `https://insane-bh.space/es?country=${language}`;
                }
                break;
            case 'US':
            case 'CA':
            case 'GB':
            case 'AU':
            case 'NZ':
            case 'IE':
            case 'ZA':
            case 'IN':
            case 'SG':
                if (window.location.pathname != '/') {
                    window.location.href = `https://insane-bh.space/?country=${language}`;
                }
                break;
            case 'JP':
                if (window.location.pathname != '/ja') {
                    window.location.href = `https://insane-bh.space/ja?country=${language}`;
                }
                break;
            case 'PT':
            case 'BR':
            case 'AO':
            case 'MZ':
            case 'CV':
            case 'GW':
            case 'ST':
            case 'GQ':
            case 'TL':
                if (window.location.pathname != '/pt') {
                    window.location.href = `https://insane-bh.space/pt?country=${language}`;
                }
                break;
            default:
                var hasDefaultCaseExecuted = false; // Flag to track if default case has executed

                // Get user's location using IP geolocation
                $.getJSON('https://ipapi.co/json/', function(data) {
                    var userCountry = data.country_code;
                    console.log(userCountry);

                    switch (userCountry) {
                        case 'US':
                        case 'CA':
                        case 'GB':
                        case 'AU':
                        case 'NZ':
                        case 'IE':
                        case 'ZA':
                        case 'IN':
                        case 'SG':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                            break;
                        case 'JP':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/ja',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/ja?country=${userCountry}`;
                            break;
                        case 'ES':
                        case 'MX':
                        case 'AR':
                        case 'CO':
                        case 'PE':
                        case 'VE':
                        case 'CL':
                        case 'EC':
                        case 'GT':
                        case 'CU':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/es',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/es?country=${userCountry}`;
                            break;
                        case 'PT':
                        case 'BR':
                        case 'AO':
                        case 'MZ':
                        case 'CV':
                        case 'GW':
                        case 'ST':
                        case 'GQ':
                        case 'TL':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/pt',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/pt?country=${userCountry}`;
                            break;
                        default:
                            if (hasDefaultCaseExecuted) {
                                // Default case already executed once, handle the situation accordingly
                                console.log('Country code not supported');
                                // You can display an error message to the user or redirect to a default URL
                            } else {
                                hasDefaultCaseExecuted = true; // Set the flag to indicate that the default case has executed
                                // Perform the redirection again
                                Cookies.set('language', userCountry, {
                                    expires: 365,
                                    path: '/',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                            }
                            break;
                    }
                });
                break;
        }
    } 
    */