/*
	$('video').each(function() {
		var videoElement = $(this)[0];
		var isBlobLoaded = false; // Flag to track if blob is loaded
		var $overlay = $('<div class="video-overlay">Loading...</div>'); // Create a loading overlay
	
		$(videoElement).prop('controls', false); // Disable video controls initially
		$(this).parent().append($overlay);
	
		var sources = $(this).find('source');
		var promises = [];
	
		sources.each(function() {
			var sourceElement = $(this)[0];
			var videoURL = $(this).attr('src');
	
			var promise = fetch(videoURL)
				.then(response => response.blob())
				.then(videoBlob => {
					var videoObjectURL = URL.createObjectURL(videoBlob);
	
					// Set the src attribute of the source element to the URL
					$(sourceElement).attr('src', videoObjectURL);
				})
				.catch(error => {
					console.error('Failed to fetch video:', error);
				});
	
			promises.push(promise);
		});
	
		Promise.all(promises)
			.then(() => {
				if (!isBlobLoaded) {
					// Call the load method on the video element to update the sources
					videoElement.load();
					isBlobLoaded = true; // Update the flag
					$(videoElement).prop('controls', true); // Enable video controls
					$overlay.remove(); // Remove the loading overlay
				}
			});
	});
	*/

	// Get all the image elements on the page
	var images = $('img');

	images.each(function(index, img) {
		var xhr = new XMLHttpRequest();
		xhr.open("GET", $(img).attr("src"), true);
		xhr.responseType = "blob";
		xhr.onload = function() {
		  if (this.status === 200) {
			var blob = this.response;
			$(img).attr("src", URL.createObjectURL(blob));
		  }
		};
		xhr.send();
	});
	// Add click event listeners to all the images
	images.click(function() {
		// Get the source of the clicked image
		var src = $(this).attr('src');

		// Create a new modal and append it to the body
		var modal = $(`<div class="modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<img class="modal-img" src="${src}">
			</div>
		</div>
	</div>`);
		modal.appendTo('body');

		// Show the modal and overlay
		modal.show();
		$('body').css('overflow', 'hidden')
		// Add a click event listener to the close button and overlay to remove the modal and overlay from the body
		modal.click(function() {
			modal.hide();
			modal.remove();
			$('body').css('overflow', 'visible')
		});

	});

	const blurDivs = $(".blur-load");
	blurDivs.each(function() {
		const img = $(this).find("img");
		const loaded = () => {
			$(this).addClass('loaded');
		};
		if (img[0].complete) {
			loaded();
		} else {
			img.on('load', loaded);
		}
	});


	/*
    function acceptedFunctionalityCookie() {
        // Your code that should run after accepting cookies goes here
        var language = Cookies.get('language');
        console.log(language);

        switch (language) {
            case 'ES':
            case 'MX':
            case 'AR':
            case 'CO':
            case 'PE':
            case 'VE':
            case 'CL':
            case 'EC':
            case 'GT':
            case 'CU':
                if (window.location.pathname != '/es') {
                    window.location.href = `https://insane-bh.space/es?country=${language}`;
                }
                break;
            case 'US':
            case 'CA':
            case 'GB':
            case 'AU':
            case 'NZ':
            case 'IE':
            case 'ZA':
            case 'IN':
            case 'SG':
                if (window.location.pathname != '/') {
                    window.location.href = `https://insane-bh.space/?country=${language}`;
                }
                break;
            case 'JP':
                if (window.location.pathname != '/ja') {
                    window.location.href = `https://insane-bh.space/ja?country=${language}`;
                }
                break;
            case 'PT':
            case 'BR':
            case 'AO':
            case 'MZ':
            case 'CV':
            case 'GW':
            case 'ST':
            case 'GQ':
            case 'TL':
                if (window.location.pathname != '/pt') {
                    window.location.href = `https://insane-bh.space/pt?country=${language}`;
                }
                break;
            default:
                var hasDefaultCaseExecuted = false; // Flag to track if default case has executed

                // Get user's location using IP geolocation
                $.getJSON('https://ipapi.co/json/', function(data) {
                    var userCountry = data.country_code;
                    console.log(userCountry);

                    switch (userCountry) {
                        case 'US':
                        case 'CA':
                        case 'GB':
                        case 'AU':
                        case 'NZ':
                        case 'IE':
                        case 'ZA':
                        case 'IN':
                        case 'SG':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                            break;
                        case 'JP':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/ja',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/ja?country=${userCountry}`;
                            break;
                        case 'ES':
                        case 'MX':
                        case 'AR':
                        case 'CO':
                        case 'PE':
                        case 'VE':
                        case 'CL':
                        case 'EC':
                        case 'GT':
                        case 'CU':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/es',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/es?country=${userCountry}`;
                            break;
                        case 'PT':
                        case 'BR':
                        case 'AO':
                        case 'MZ':
                        case 'CV':
                        case 'GW':
                        case 'ST':
                        case 'GQ':
                        case 'TL':
                            Cookies.set('language', userCountry, {
                                expires: 365,
                                path: '/pt',
                                domain: 'insane-bh.space',
                                secure: true,
                                sameSite: 'Strict',
                            });
                            window.location.href = `https://insane-bh.space/pt?country=${userCountry}`;
                            break;
                        default:
                            if (hasDefaultCaseExecuted) {
                                // Default case already executed once, handle the situation accordingly
                                console.log('Country code not supported');
                                // You can display an error message to the user or redirect to a default URL
                            } else {
                                hasDefaultCaseExecuted = true; // Set the flag to indicate that the default case has executed
                                // Perform the redirection again
                                Cookies.set('language', userCountry, {
                                    expires: 365,
                                    path: '/',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                            }
                            break;
                    }
                });
                break;
        }
    } 
    */


    <!--
                            <div class="slice-img"><div class="blur-load"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=" data-src="./img/SEO_IMAGES/Ashnage-Birthday-min.webp" alt="Ash Party" loading="lazy"></div></div>
                            <div class="slice-img"><div class="blur-load"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=" data-src="./img/SEO_IMAGES/chibi-min.webp" alt="Chibi" loading="lazy"></div></div>
                            <div class="slice-img"><div class="blur-load"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=" data-src="./img/SEO_IMAGES/insane banner-min.webp" alt="The Squad" loading="lazy"></div></div>



                            <section class="middle-banner shuffle-section">
                                <div class="social-banner">
                                    <div class="row gx-0 h-100">
                                        <div class="col-sm-4 col-md-4 col-lg-4 d-flex justify-content-center align-items-center">
                                            <a class="link-to" href="https://twitter.com/INSaNE_BH" target="_blank" rel="noopener noreferrer">
                                                <div class="row gx-0">
                                                    <div class="col-sm-4 col-12 d-flex align-content-center justify-content-center"><span class="fw-bolder">TWITTER <i class="bi bi-twitter"></i></span></div>
                                                </div>
                                            </a>
                                        </div>
                                        <div class="col-sm-4 col-md-4 col-lg-4 d-flex justify-content-center align-items-center">
                                            <a class="link-to" href="#former-form" id="to-mail">
                                                <div class="row gx-0">
                                                    <div class="col-sm-4 col-12 d-flex align-content-center justify-content-center"><span class="fw-bolder">MAIL <i class="bi bi-envelope"></i></span></div>
                                                </div>
                                            </a>
                                        </div>
                                        <div class="col-sm-4 col-md-4 col-lg-4 d-flex justify-content-center align-items-center">
                                            <a class="link-to" href="https://discord.gg/EcfGKcSNYg" target="_blank" rel="noopener noreferrer">
                                                <div class="row gx-0">
                                                    <div class="col-sm-4 col-12 d-flex align-content-center justify-content-center"><span class="fw-bolder">DISCORD <i class="bi bi-discord"></i></span></div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            -->

                            /*function acceptedFunctionalityCookie() {
        // Your code that should run after accepting cookies goes here
        var language = Cookies.get('language');
        console.log(language);
    
        switch (language) {
            case 'ES':
            case 'MX':
            case 'AR':
            case 'CO':
            case 'PE':
            case 'VE':
            case 'CL':
            case 'EC':
            case 'GT':
            case 'CU':
                if (window.location.pathname !== '/es') {
                    window.location.href = `https://insane-bh.space/es?country=${language}`;
                }
                break;
            case 'US':
            case 'CA':
            case 'GB':
            case 'AU':
            case 'NZ':
            case 'IE':
            case 'ZA':
            case 'IN':
            case 'SG':
                if (window.location.pathname !== '/') {
                    window.location.href = `https://insane-bh.space/?country=${language}`;
                }
                break;
            case 'JP':
                if (window.location.pathname !== '/ja') {
                    window.location.href = `https://insane-bh.space/ja?country=${language}`;
                }
                break;
            case 'PT':
            case 'BR':
            case 'AO':
            case 'MZ':
            case 'CV':
            case 'GW':
            case 'ST':
            case 'GQ':
            case 'TL':
                if (window.location.pathname !== '/pt') {
                    window.location.href = `https://insane-bh.space/pt?country=${language}`;
                }
                break;
            default:
                
                try {
                    var hasDefaultCaseExecuted = false; // Flag to track if default case has executed
                    // Get user's location using IP geolocation
                        $.getJSON('https://ipapi.co/json/', function(data) {
                            var userCountry = data.country_code;
                            console.log(userCountry);
    
                            switch (userCountry) {
                                case 'US':
                                case 'CA':
                                case 'GB':
                                case 'AU':
                                case 'NZ':
                                case 'IE':
                                case 'ZA':
                                case 'IN':
                                case 'SG':
                                    if (language !== userCountry) {
                                        Cookies.set('language', userCountry, {
                                            expires: 365,
                                            path: '/',
                                            domain: 'insane-bh.space',
                                            secure: true,
                                            sameSite: 'Strict',
                                        });
                                        window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                                    }
                                    break;
                                case 'JP':
                                    if (language !== userCountry) {
                                        Cookies.set('language', userCountry, {
                                            expires: 365,
                                            path: '/ja',
                                            domain: 'insane-bh.space',
                                            secure: true,
                                            sameSite: 'Strict',
                                        });
                                        window.location.href = `https://insane-bh.space/ja?country=${userCountry}`;
                                    }
                                    break;
                                case 'ES':
                                case 'MX':
                                case 'AR':
                                case 'CO':
                                case 'PE':
                                case 'VE':
                                case 'CL':
                                case 'EC':
                                case 'GT':
                                case 'CU':
                                    if (language !== userCountry) {
                                        Cookies.set('language', userCountry, {
                                            expires: 365,
                                            path: '/es',
                                            domain: 'insane-bh.space',
                                            secure: true,
                                            sameSite: 'Strict',
                                        });
                                        window.location.href = `https://insane-bh.space/es?country=${userCountry}`;
                                    }
                                    break;
                                case 'PT':
                                case 'BR':
                                case 'AO':
                                case 'MZ':
                                case 'CV':
                                case 'GW':
                                case 'ST':
                                case 'GQ':
                                case 'TL':
                                    if (language !== userCountry) {
                                        Cookies.set('language', userCountry, {
                                            expires: 365,
                                            path: '/pt',
                                            domain: 'insane-bh.space',
                                            secure: true,
                                            sameSite: 'Strict',
                                        });
                                        window.location.href = `https://insane-bh.space/pt?country=${userCountry}`;
                                    }
                                    break;
                                default:
                                    if (hasDefaultCaseExecuted) {
                                        // Default case already executed once, handle the situation accordingly
                                        console.log('Country code not supported');
                                        // You can display an error message to the user or redirect to a default URL
                                    } else {
                                        hasDefaultCaseExecuted = true; // Set the flag to indicate that the default case has executed
                                        // Perform the redirection again
                                        Cookies.set('language', userCountry, {
                                            expires: 365,
                                            path: '/',
                                            domain: 'insane-bh.space',
                                            secure: true,
                                            sameSite: 'Strict',
                                        });
                                        window.location.href = `https://insane-bh.space/?country=${userCountry}`;
                                    }
                                    break;
                            }
    
                    });
                } catch (error) {
                    // API failed to retrieve country code, fallback to browser language detection
                    var browserLanguage = navigator.language || navigator.userLanguage;
                    var browserLangCode = browserLanguage.split('-')[0].toLowerCase();
                    console.log(browserLangCode);
    
                    switch (browserLangCode) {
                        case 'es':
                            if (language !== 'ES') {
                                Cookies.set('language', 'ES', {
                                    expires: 365,
                                    path: '/es',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/es?country=ES`;
                            }
                            break;
                        case 'en':
                            if (language !== 'US') {
                                Cookies.set('language', 'US', {
                                    expires: 365,
                                    path: '/',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/?country=US`;
                            }
                            break;
                        case 'ja':
                            if (language !== 'JP') {
                                Cookies.set('language', 'JP', {
                                    expires: 365,
                                    path: '/ja',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/ja?country=JP`;
                            }
                            break;
                        case 'pt':
                            if (language !== 'PT') {
                                Cookies.set('language', 'PT', {
                                    expires: 365,
                                    path:'/pt',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/pt?country=PT`;
                            }
                            break;
                        default:
                            if (language !== 'US') {
                                Cookies.set('language', 'US', {
                                    expires: 365,
                                    path: '/',
                                    domain: 'insane-bh.space',
                                    secure: true,
                                    sameSite: 'Strict',
                                });
                                window.location.href = `https://insane-bh.space/?country=US`;
                            }
                            break;
                    }
                }
                break;
        }
    }*/


    /*
    class LazyImageLoader {
        constructor() {
            this.options = {
                root: null, // Use the viewport as the root
                rootMargin: '0px', // No margin
                threshold: 0.1 // Trigger when 10% of the image is visible
            };

            this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
        }

        loadImages() {
            const images = $('img');
            const imagePromises = [];

            images.each((index, img) => {
                const dataSrc = $(img).attr('data-src');
                const dataModule = $(img).attr('data-module');
                const dataBlur = $(img).attr('data-blur');

                if (!dataSrc || (!dataModule && dataModule !== 'true')) {
                    // Skip images without data-src property
                    return;
                }

                $(img).on('dragstart', function() {
                    return false;
                })

                // Check if the image is already wrapped
                // Check if data-blur is set to true
                if (dataBlur === 'true' && !$(img).parent().hasClass('blur-load')) {
                    // Wrap the img tag inside a div with the class 'blur-load'
                    $(img).wrap('<div class="blur-load"></div>');
                }

                $(img).attr('src', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=')

                const promise = new Promise((resolve, reject) => {
                    this.observer.observe(img);

                    img.onload = function() {
                        resolve();
                    };

                    img.onerror = function() {
                        reject(new Error(`Failed to load image: ${img.src}`));
                    };
                });

                let downloadMSN;
                switch (window.location.href.split("?")[0]) {
                    case 'https://insane-bh.space':
                        downloadMSN = 'Download'
                        break;
                    case 'https://insane-bh.space/es':
                        downloadMSN = 'Descarga'
                        break;
                    case 'https://insane-bh.space/ja':
                        downloadMSN = 'ダウンロード'
                        break;
                    case 'https://insane-bh.space/pt':
                        downloadMSN = 'Baixar'
                        break;
                    default:
                        downloadMSN = 'Download'
                        break;
                }

                if (dataModule === 'true') {
                    $(img).click(function() {
                        const src = $(this).attr('src');
                        const modal = $(`
                        <div class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                <img class="modal-img img-fluid inherit" src="${src}" ondragstart="return false;">
                                <a class="download-btn" href="${src}" download>${downloadMSN}</a>
                                </div>
                            </div>
                        </div>
                        `);

                        modal.appendTo('body');

                        modal.show();
                        $('body').css('overflow', 'hidden');

                        modal.click(function() {
                            modal.hide();
                            modal.remove();
                            $('body').css('overflow', 'visible');
                        });
                    });
                }

                imagePromises.push(promise);
            });

            const blurDivs = $(".blur-load");

            blurDivs.each(function() {
                const img = $(this).find("img");

                const loaded = () => {
                    $(this).addClass('loaded');
                };

                if (img[0].complete) {
                    loaded();
                } else {
                    img.on('load', loaded);
                }
            });

            return imagePromises;
        }

        handleIntersection(entries, observer) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const imgElement = entry.target;
                    this.lazyLoadImage(imgElement);
                    observer.unobserve(imgElement);
                }
            });
        }

        lazyLoadImage(imgElement) {
            const src = $(imgElement).attr('data-src'); // Use data-src attribute instead of src

            // Skip the XHR request if the src attribute already contains a valid image URL
            if (src && (src.startsWith('data:') || src.startsWith('http://') || src.startsWith('https://'))) {
                const parentDiv = $(imgElement).parent();
                parentDiv.addClass('loaded');
                return Promise.resolve();
            }

            const xhr = new XMLHttpRequest();

            const promise = new Promise((resolve, reject) => {
                xhr.open('GET', src, true);
                xhr.responseType = 'blob';
                xhr.onload = function() {
                    if (this.status === 200) {
                        const blob = this.response;
                        $(imgElement).attr('src', URL.createObjectURL(blob));
                        resolve();
                    } else {
                        reject(new Error(`Failed to load image: ${src}`));
                    }
                };
                xhr.onerror = function() {
                    reject(new Error(`Failed to load image: ${src}`));
                };
                xhr.send();
            });

            promise
                .then(() => {
                    const parentDiv = $(imgElement).parent();
                    parentDiv.addClass('loaded');
                })
                .catch(error => {
                    console.error(error);
                });

            return promise;
        }
    }

    const lazyImageLoader = new LazyImageLoader();
    const imagePromises = lazyImageLoader.loadImages();

    Promise.all(imagePromises)
        .then(() => {
            console.log('All images loaded successfully');
        })
        .catch(error => {
            console.error('Failed to load images:', error);
        }); 
    */


    /*
        function acceptedFunctionalityCookie() {
        // Your code that should run after accepting cookies goes here
        var language = Cookies.get('language');
        console.log(language);
    
        switch (language) {
            case 'ES':
            case 'MX':
            case 'AR':
            case 'CO':
            case 'PE':
            case 'VE':
            case 'CL':
            case 'EC':
            case 'GT':
            case 'CU':
                if (window.location.pathname !== '/es') {
                    window.location.href = `https://insane-bh.space/es?country=${language}`;
                }
                break;
            case 'US':
            case 'CA':
            case 'GB':
            case 'AU':
            case 'NZ':
            case 'IE':
            case 'ZA':
            case 'IN':
            case 'SG':
                if (window.location.pathname !== '/') {
                    window.location.href = `https://insane-bh.space/?country=${language}`;
                }
                break;
            case 'JP':
                if (window.location.pathname !== '/ja') {
                    window.location.href = `https://insane-bh.space/ja?country=${language}`;
                }
                break;
            case 'PT':
            case 'BR':
            case 'AO':
            case 'MZ':
            case 'CV':
            case 'GW':
            case 'ST':
            case 'GQ':
            case 'TL':
                if (window.location.pathname !== '/pt') {
                    window.location.href = `https://insane-bh.space/pt?country=${language}`;
                }
                break;
            default:
                // Get user's location using IP geolocation
                $.getJSON('https://ipapi.co/json/')
                    .done(function(data) {
                        var userCountry = data.country_code;
                        console.log(userCountry);
            
                        // Perform redirection based on user's country
                        performRedirection(userCountry, language);
                    })
                    .fail(function(jqXHR, textStatus, errorThrown) {
                        console.error('Failed to retrieve country code:', textStatus, errorThrown);
                        
                        // API failed to retrieve country code, fallback to browser language detection
                        var browserLanguage = navigator.language || navigator.userLanguage;
                        var browserLangCode = browserLanguage.split('-')[0].toUpperCase();
                        console.log(browserLangCode);
            
                        // Perform redirection based on browser's language
                        performRedirection(browserLangCode, language);
                    });
                break;
        }
    }
    
    function performRedirection(userCountry, language) {
        var hasDefaultCaseExecuted = false; // Flag to track if default case has executed
        switch (userCountry) {
            case 'US':
            case 'CA':
            case 'GB':
            case 'AU':
            case 'NZ':
            case 'IE':
            case 'ZA':
            case 'IN':
            case 'SG':
                if (language !== userCountry) {
                    redirectToCountry('https://insane-bh.space/?country=', userCountry);
                }
                break;
            case 'JP':
                if (language !== userCountry) {
                    redirectToCountry('https://insane-bh.space/ja?country=', userCountry);
                }
                break;
            case 'ES':
            case 'MX':
            case 'AR':
            case 'CO':
            case 'PE':
            case 'VE':
            case 'CL':
            case 'EC':
            case 'GT':
            case 'CU':
                if (language !== userCountry) {
                    redirectToCountry('https://insane-bh.space/es?country=', userCountry);
                }
                break;
            case 'PT':
            case 'BR':
            case 'AO':
            case 'MZ':
            case 'CV':
            case 'GW':
            case 'ST':
            case 'GQ':
            case 'TL':
                if (language !== userCountry) {
                    redirectToCountry('https://insane-bh.space/pt?country=', userCountry);
                }
                break;
            default:
                if (hasDefaultCaseExecuted) {
                    // Default case already executed once, handle the situation accordingly
                    console.log('Country code not supported');
                    // You can display an error message to the user or redirect to a default URL
                } else {
                    hasDefaultCaseExecuted = true; // Set the flag to indicate that the default case has executed
                    // Perform the redirection again
                    redirectToCountry('https://insane-bh.space/?country=', userCountry);
                }
                break;
        }
    }
    
    function redirectToCountry(baseUrl, country) {
        Cookies.set('language', country, {
            expires: 365,
            path: '/',
            domain: 'insane-bh.space',
            secure: true,
            sameSite: 'Strict',
        });
        window.location.href = baseUrl + country;
    } 
    */   


    /*
        var form = $('#former-form')
    form.on('submit', function(e) {
        e.preventDefault()
        let langMSG = {}
        switch (window.location.href.split("?")[0]) {
            case 'https://insane-bh.space':
                langMSG = {
                    notiMSGAccepted: "Your form has been submitted.",
                    bodyMSGAccepted: "Congratulations! Our team will be in touch with you soon.",
                    notiMSGRejected: "Your form couldn't be submitted.",
                    bodyMSGRejected: "An error has occurred. Please try again."
                };
                break;
            case 'https://insane-bh.space/es':
                langMSG = {
                    notiMSGAccepted: "Su formulario ha sido enviado.",
                    bodyMSGAccepted: "¡Enhorabuena! Nuestro equipo se pondrá en contacto con usted pronto.",
                    notiMSGRejected: "No se pudo enviar su formulario.",
                    bodyMSGRejected: "Ha ocurrido un error. Por favor, inténtelo de nuevo."
                };
                break;
            case 'https://insane-bh.space/ja':
                langMSG = {
                    notiMSGAccepted: "フォームが送信されました。",
                    bodyMSGAccepted: "おめでとうございます。弊社チームがお客様に近日中に連絡いたします。",
                    notiMSGRejected: "フォームの送信に失敗しました。",
                    bodyMSGRejected: "エラーが発生しました。もう一度お試しください。"
                };
                break;
            case 'https://insane-bh.space/pt':
                langMSG = {
                    notiMSGAccepted: "Sua mensagem foi enviada.",
                    bodyMSGAccepted: "Parabéns! Em breve, nossa equipe entrará em contato com você.",
                    notiMSGRejected: "Não foi possível enviar sua mensagem.",
                    bodyMSGRejected: "Ocorreu um erro. Por favor, tente novamente."
                };
                break;
            default:
                // Handle any other URLs
                langMSG = {
                    notiMSGAccepted: "Your form has been submitted.",
                    bodyMSGAccepted: "Congratulations! Our team will be in touch with you soon.",
                    notiMSGRejected: "Your form couldn't be submitted.",
                    bodyMSGRejected: "An unexpected error occurred. Please try again."
                };
                break;
        }

        let tymsg = $(this).attr('data-tymsg')
        let errmsg = $(this).attr('data-errmsg')
        console.log(tymsg, errmsg)
        $.ajax({
            method: 'POST',
            url: 'https://formsubmit.co/ajax/70a19f04e48d9da8774f32b49b924edf',
            dataType: 'json',
            accepts: 'application/json',
            data: {
                name: $('#name').val(),
                mail: $('#mail').val(),
                message: $('#message').val()
            },
            success: (data) => {
                Notification.requestPermission().then(perm => {
                    if (perm === "granted") {
                        new Notification(langMSG.notiMSGAccepted, {
                            body: langMSG.bodyMSGAccepted,
                            icon: "img/webiconspace-removebg-preview.png"
                        });
                    }
                });
                form.css('display', 'none');
                $('.form-container').html(tymsg);
            },
            error: (err) => {
                Notification.requestPermission().then(perm => {
                    if (perm === "granted") {
                        new Notification(langMSG.notiMSGRejected, {
                            body: langMSG.bodyMSGRejected,
                            icon: "img/webiconspace-removebg-preview.png"
                        });
                    }
                });
                form.css('display', 'none');
                $('.form-container').html(errmsg);
            }
        });

    })
    */

    <!--<div class="owl-nav customized">
                <button aria-label="Previous" type="button" role="presentation" class="owl-prev">
                    <span>
                        <div class="arrow-btn left-one">
                            <div class="arrow-left">
                            </div>
                        </div>
                    </span>
                </button>
                <button aria-label="Next" type="button" role="presentation" class="owl-next">
                    <span>
                        <div class="arrow-btn right-one">
                            <div class="arrow-right">
                            </div>
                        </div>
                    </span>
                </button>
            </div>-->

            /*
    class LazyImageLoader {
        constructor() {
            this.options = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
            this.downloadMSN = this.getDownloadMSN();
        }

        loadImages() {
            return $('img').map((index, img) => {
                const $img = $(img);
                const dataSrc = $img.attr('data-src');
                const dataModule = $img.attr('data-module');
                const dataBlur = $img.attr('data-blur');

                if (!dataSrc || (!dataModule && dataModule !== 'true')) {
                    return;
                }

                $img.on('dragstart', function() {
                    return false;
                })

                if (dataBlur === 'true' && !$img.parent().hasClass('blur-load')) {
                    $img.wrap('<div class="blur-load"></div>');
                }

                $img.attr('src', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=')

                this.observer.observe(img);

                if (dataModule === 'true') {
                    this.setupModalImage($img);
                }

                return this.imageLoadPromise($img);
            }).get();
        }

        handleIntersection(entries, observer) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const imgElement = entry.target;
                    this.lazyLoadImage($(imgElement));
                    observer.unobserve(imgElement);
                }
            });
        }

        lazyLoadImage($imgElement) {
            const src = $imgElement.attr('data-src');

            if (src && (src.startsWith('data:') || src.startsWith('http://') || src.startsWith('https://'))) {
                $imgElement.parent().addClass('loaded');
                return Promise.resolve();
            }

            return $.ajax({
                url: src,
                xhrFields: {
                    responseType: 'blob'
                },
                success: (blob) => {
                    $imgElement.attr('src', URL.createObjectURL(blob));
                    $imgElement.parent().addClass('loaded');
                },
                error: () => console.error(`Failed to load image: ${src}`)
            });
        }

        imageLoadPromise($img) {
            return new Promise((resolve, reject) => {
                $img.on('load', () => resolve());
                $img.on('error', () => reject(new Error(`Failed to load image: ${$img.src}`)));
            });
        }

        setupModalImage($img) {
            $img.on('click', () => {
                const src = $img.attr('src');
                const $modal = $(
                    `<div class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                <img class="modal-img img-fluid inherit" src="${src}" ondragstart="return false;">
                                <a class="download-btn" href="${src}" download>${this.downloadMSN}</a>
                                </div>
                            </div>
                        </div>`
                );

                $modal.appendTo('body').show();
                $('body').css('overflow', 'hidden');

                $modal.on('click', () => {
                    $modal.hide().remove();
                    $('body').css('overflow', 'visible');
                });
            });
        }

        getDownloadMSN() {
            switch (window.location.href.split("?")[0]) {
                case 'https://insane-bh.space':
                    return 'Download';
                case 'https://insane-bh.space/es':
                    return 'Descarga';
                case 'https://insane-bh.space/ja':
                    return 'ダウンロード';
                case 'https://insane-bh.space/pt':
                    return 'Baixar';
                default:
                    return 'Download';
            }
        }
    }

    const lazyImageLoader = new LazyImageLoader();
    const imagePromises = lazyImageLoader.loadImages();

    Promise.all(imagePromises)
        .then(() => console.log('All images loaded successfully'))
        .catch(error => console.error('Failed to load images:', error));
    */

    class LazyVideoLoader {
        constructor() {
            this.options = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
        }

        loadVideos() {
            $('video').each((index, videoElement) => {
                this.observer.observe(videoElement);
            });
        }

        handleIntersection(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const video = $(entry.target);
                    this.lazyLoadVideo(video);
                    this.lazyLoadPoster(video);
                    this.observer.unobserve(entry.target);
                }
            });
        }

        fetchVideoSource(src) {
            return fetch(src)
                .then(response => response.blob())
                .then(blob => URL.createObjectURL(blob))
                .catch(err => {
                    console.error(`Failed to fetch video: ${err}`);
                    return '';
                });
        }

        lazyLoadPoster(video) {
            const posterURL = video.attr('data-poster');
            if (posterURL) {
                fetch(posterURL)
                    .then(response => response.blob())
                    .then(blob => {
                        const objectURL = URL.createObjectURL(blob);
                        video.attr('poster', objectURL);
                    })
                    .catch(err => {
                        console.error(`Failed to load poster image: ${err}`);
                    });
            }
        }

        lazyLoadVideo(video) {
            const sources = video.find('source');
            const overlay = this.createOverlay(video);

            video.prop('controls', false);

            const promises = sources.map((index, sourceElement) => {
                const source = $(sourceElement);
                const videoURL = source.attr('data-src');

                return this.fetchVideoSource(videoURL)
                    .then(videoObjectURL => {
                        if (videoObjectURL) {
                            source.attr('src', videoObjectURL);
                        } else {
                            console.error(`Unable to load video from source: ${videoURL}`);
                        }
                    });
            }).get(); // get() is used to convert jQuery object to array

            $.when.apply($, promises).then(() => {
                video[0].load();
                this.setupPlayButton(overlay, video);
            });
        }

        createOverlay(video) {
            const overlay = $('<div>', {
                class: 'video-overlay',
                text: 'Loading...'
            });

            video.parent().append(overlay);

            return overlay;
        }

        setupPlayButton(overlay, video) {
            const playButtonTemplate = `
                <div class="play-button-overlay d-flex align-items-center justify-content-center">
                    <button class="play-button btn btn-danger btn-lg" aria-label="Play Button">
                        ▶
                    </button>
                </div>
            `;

            overlay.html(playButtonTemplate);

            video.on('loadedmetadata', () => video.prop('controls', false));

            overlay.find('.play-button').on('click', () => {
                overlay.remove();
                video.prop('controls', true);
                video[0].play();
            });

            video.on('ended', () => {
                video.parent().append(overlay);
                overlay.html(playButtonTemplate);
                video.prop('controls', false);

                overlay.find('.play-button').on('click', () => {
                    overlay.remove();
                    video.prop('controls', true);
                    video[0].currentTime = 0;
                    video[0].play();
                });
            });
        }
    }

    const lazyVideoLoader = new LazyVideoLoader();
    $(document).ready(() => lazyVideoLoader.loadVideos());


    /*
    class LazyVideoLoader {
        constructor() {
            this.options = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };
    
            this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
        }
    
        loadVideos() {
            $('video').each((index, videoElement) => {
                this.observer.observe(videoElement);
            });
        }
    
        handleIntersection(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const video = $(entry.target);
                    this.lazyLoadVideo(video);
                    this.lazyLoadPoster(video);
                    this.observer.unobserve(entry.target);
                }
            });
        }
    
        fetchVideoSource(src) {
            return fetch(src)
                .then(response => response.blob())
                .then(blob => URL.createObjectURL(blob))
                .catch(err => {
                    console.error(`Failed to fetch video: ${err}`);
                    return '';
                });
        }
    
        lazyLoadPoster(video) {
            const posterData = video.attr('data-poster');
    
            if (posterData) {
                let posterObject;
                try {
                    posterObject = JSON.parse(posterData);
                } catch {
                    console.error(`Unable to parse poster data: ${posterData}`);
                    return;
                }
    
                const posterPriorityList = Object.keys(posterObject).sort();
                this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, 0);
            }
        }
    
        loadPostersFromPriorityList(video, posterObject, posterPriorityList, index) {
            if (index >= posterPriorityList.length) {
                console.log(`All posters attempted for video: ${index + 1}`);
                return;
            }
    
            const posterPriority = posterPriorityList[index];
            const posterURL = posterObject[posterPriority];
    
            fetch(posterURL)
                .then(response => response.blob())
                .then(blob => {
                    const objectURL = URL.createObjectURL(blob);
                    video.attr('poster', objectURL);
                    video.attr(`data-object-poster-${posterPriority}`, objectURL);
                })
                .catch(err => {
                    console.error(`Failed to load poster image from URL ${posterURL}: ${err}`);
                })
                .finally(() => {
                    this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, index + 1);
                });
        }
    

        lazyLoadVideo(video) {
            const sources = video.find('source');
            const overlay = this.createOverlay(video);
    
            video.prop('controls', false);
    
            const promises = sources.map((index, sourceElement) => {
                const source = $(sourceElement);
                const videoURL = source.attr('data-src');
    
                return this.fetchVideoSource(videoURL)
                    .then(videoObjectURL => {
                        if (videoObjectURL) {
                            source.attr('src', videoObjectURL);
                        } else {
                            console.error(`Unable to load video from source: ${videoURL}`);
                        }
                    });
            }).get();
    
            $.when.apply($, promises).then(() => {
                video[0].load();
                this.setupPlayButton(overlay, video);
            });
        }
    
        createOverlay(video) {
            const overlay = $('<div>', {
                class: 'video-overlay',
                text: 'Loading...'
            });
    
            video.parent().append(overlay);
            return overlay;
        }
    
        setupPlayButton(overlay, video) {
            const playButtonTemplate = `
                <div class="play-button-overlay d-flex align-items-center justify-content-center">
                    <button class="play-button btn btn-danger btn-lg" aria-label="Play Button">
                        ▶
                    </button>
                </div>
            `;
    
            overlay.html(playButtonTemplate);
    
            video.on('loadedmetadata', () => video.prop('controls', false));
    
            overlay.find('.play-button').on('click', () => {
                overlay.remove();
                video.prop('controls', true);
                video[0].play();
            });
    
            video.on('ended', () => {
                video.parent().append(overlay);
                overlay.html(playButtonTemplate);
                video.prop('controls', false);
    
                overlay.find('.play-button').on('click', () => {
                    overlay.remove();
                    video.prop('controls', true);
                    video[0].currentTime = 0;
                    video[0].play();
                });
            });
        }
    }
    
    const lazyVideoLoader = new LazyVideoLoader();
    $(document).ready(() => lazyVideoLoader.loadVideos());
    */


    /*
       class CookieManager {
        constructor(customCases, targetPage) {
            this.baseUrl = targetPage;
            this.hasDefaultCaseExecuted = false;
            this.langCases = customCases;
        }

        acceptedFunctionalityCookie() {
            var language = Cookies.get('language');
            console.log(language);

            for (let [key, value] of Object.entries(this.langCases)) {
                if (key === language || value[1].includes(language)) {
                    if (window.location.pathname !== value[0]) {
                        window.location.href = `${this.baseUrl}${value[0]}?country=${language}`;
                    }
                    return;
                }
            }

            // Default Case
            $.getJSON('https://ipapi.co/json/')
                .done((data) => this.performRedirection(data.country_code, language))
                .fail((jqXHR, textStatus, errorThrown) => {
                    console.error('Failed to retrieve country code:', textStatus, errorThrown);
                    const browserLanguage = (navigator.language || navigator.userLanguage).split('-')[0].toUpperCase();
                    console.log(browserLanguage);
                    this.performRedirection(browserLanguage, language);
                });
        }

        performRedirection(userCountry, language) {
            for (let [key, value] of Object.entries(this.langCases)) {
                if (key === userCountry || value[1].includes(userCountry)) {
                    if (language !== userCountry) {
                        this.redirectToCountry(`${this.baseUrl}${value[0]}?country=`, userCountry);
                    }
                    return;
                }
            }

            // Default Case
            if (this.hasDefaultCaseExecuted) {
                console.log('Country code not supported');
            } else {
                this.hasDefaultCaseExecuted = true;
                this.redirectToCountry(`${this.baseUrl}/?country=`, userCountry);
            }
        }

        redirectToCountry(baseUrl, country) {
            Cookies.set('language', country, {
                expires: 365,
                path: '/',
                domain: this.baseUrl,
                secure: true,
                sameSite: 'Strict',
            });
            window.location.href = baseUrl + country;
        }
    }  
    */


    class LazyVideoLoader {
        constructor() {
            this.options = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };
    
            this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
            this.isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }
    
        loadVideos() {
            $('video').each((index, videoElement) => {
                $(videoElement).attr('id', `video-${index}`); // Assign ID to each video
                this.observer.observe(videoElement);
            });
        }
    
        handleIntersection(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const video = $(entry.target);
                    video.data('posters', []);  // Initialize 'posters' data on each video
                    this.lazyLoadVideo(video);
                    this.lazyLoadPoster(video);
                    this.observer.unobserve(entry.target);
                }
            });
        }
    
        fetchVideoSource(src) {
            return fetch(src)
                .then(response => response.blob())
                .then(blob => URL.createObjectURL(blob))
                .catch(err => {
                    console.error(`Failed to fetch video: ${err}`);
                    return '';
                });
        }
    
        lazyLoadPoster(video) {
            const posterData = video.attr('data-poster');
    
            if (posterData) {
                let posterObject;
                try {
                    posterObject = JSON.parse(posterData);
                } catch {
                    console.error(`Unable to parse poster data: ${posterData}`);
                    return;
                }
    
                const posterPriorityList = Object.keys(posterObject).sort();
                this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, 0);
            }
        }
    
        loadPostersFromPriorityList(video, posterObject, posterPriorityList, index = 0) {
            if (index >= posterPriorityList.length) {
                console.log(`All posters attempted for video`);
                return;
            }
        
            const posterPriority = posterPriorityList[index];
            const posterURL = posterObject[posterPriority];
            console.log(`Loading poster with priority ${posterPriority} from URL ${posterURL}`);
        
            fetch(posterURL)
                .then(response => response.blob())
                .then(blob => {
                    const objectURL = URL.createObjectURL(blob);
                    video.data('posters').push(objectURL);  // Store each loaded poster URL in 'posters' data
        
                    if (index === 0) {  // Set the first loaded poster as the video poster
                        video.attr('poster', objectURL);
                        if (this.isMobile) { // If mobile, start loading second poster right away
                            this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, index + 1);
                        }
                    } else if (this.isMobile) { // If mobile and second poster has loaded, replace the first one
                        video.attr('poster', objectURL);
                    }
        
                    this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, index + 1);
                })
                .catch(err => {
                    console.error(`Failed to load poster image from URL ${posterURL}: ${err}`);
                    this.loadPostersFromPriorityList(video, posterObject, posterPriorityList, index + 1);
                });
        }               
    
        lazyLoadVideo(video) {
            const sources = video.find('source');
            const overlay = this.createOverlay(video);
            video.prop('controls', false);
        
            const promises = sources.map((index, sourceElement) => {
                const source = $(sourceElement);
                const videoURL = source.attr('data-src');
        
                return this.fetchVideoSource(videoURL)
                    .then(videoObjectURL => {
                        if (videoObjectURL) {
                            source.attr('src', videoObjectURL);
                            return videoObjectURL;
                        } else {
                            throw new Error(`Unable to load video from source: ${videoURL}`);
                        }
                    });
            }).get();
        
            $.when.apply($, promises).then(() => {
                video[0].load();
                this.setupPlayButton(overlay, video);
                this.checkAndApplyHover(video);  // Check and apply hover effect after video sources are loaded
            });
        }
    
        createOverlay(video) {
            const overlay = $('<div>', {
                class: 'video-overlay',
                text: 'Loading...'
            });
    
            video.parent().append(overlay);
            return overlay;
        }
    
        setupPlayButton(overlay, video) {
            const playButtonTemplate = `
                <div class="play-button-overlay d-flex align-items-center justify-content-center">
                    <button class="play-button btn btn-danger btn-lg" aria-label="Play Button" data-video-id="${video.attr('id')}">
                        <span class="btn-iris"></span>
                    </button>
                </div>
            `;
    
            overlay.html(playButtonTemplate);
    
            video.on('loadedmetadata', () => video.prop('controls', false));
    
            overlay.find('.play-button').on('click', () => {
                overlay.remove();
                video.prop('controls', true);
                video[0].play();
            });
    
            video.on('ended', () => {
                const posters = video.data('posters');
                video[0].load()
                video.parent().append(overlay);
                overlay.html(playButtonTemplate);
                video.prop('controls', false);
                video.attr('poster', posters[0]);
    
                overlay.find('.play-button').on('click', () => {
                    overlay.remove();
                    video.prop('controls', true);
                    video[0].play();
                });
                if (!this.isMobile) {
                    this.checkAndApplyHover(video);
                    video.attr('poster', posters[0]);
                } else {
                    if (posters.length > 1) {
                        video.attr('poster', posters[1]);
                    } else {
                        video.attr('poster', posters[0]);
                    }
                }
            });
        }
    
        checkAndApplyHover(video) {
            const posters = video.data('posters');
    
            if (posters.length > 1) {
                if (!this.isMobile) {
                    // On desktop, switch poster image on hover
                    const overlay = video.siblings('.video-overlay');
                    const playButton = overlay.find('.play-button');
                    playButton.hover(
                        () => video.attr('poster', posters[1]),
                        () => video.attr('poster', posters[0])
                    );
                }
            }
        }
    }
    
    const lazyVideoLoader = new LazyVideoLoader();
    $(document).ready(() => lazyVideoLoader.loadVideos());

    class LazyImageLoader {
            constructor() {
                this.options = {
                    root: null,
                    rootMargin: '0px',
                    threshold: 0.1
                };
        
                this.observer = new IntersectionObserver(this.handleIntersection.bind(this), this.options);
                this.downloadMSN = this.getDownloadMSN();
            }
        
            loadImages() {
                return $('img').map((index, img) => {
                    const $img = $(img);
                    const dataSrc = $img.attr('data-src');
                    const dataModule = $img.attr('data-module');
                    const dataBlur = $img.attr('data-blur');
        
                    if (!dataSrc || (!dataModule && dataModule !== 'true')) {
                        return;
                    }
        
                    $img.on('dragstart', function() {
                        return false;
                    })
        
                    if (dataBlur === 'true' && !$img.parent().hasClass('blur-load')) {
                        $img.wrap('<div class="blur-load"></div>');
                    }
        
                    $img.attr('src', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiB2aWV3Qm94PSIwIDAgNTAwIDUwMCI+DQogIDxyZWN0IGZpbGw9InRyYW5zcGFyZW50IiB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIvPg0KICA8dGV4dCBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU1LDI1NS41KSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMzAiIGR5PSIxMC41IiBmb250LXdlaWdodD0iYm9sZCIgeD0iNTAlIiB5PSI1MCUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvYWRpbmcuLi48L3RleHQ+DQo8L3N2Zz4=')
        
                    this.observer.observe(img);
        
                    if (dataModule === 'true') {
                        this.setupModalImage($img);
                    }
        
                    return this.imageLoadPromise($img);
                }).get();
            }
        
            handleIntersection(entries, observer) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const imgElement = entry.target;
                        this.lazyLoadImage($(imgElement));
                        observer.unobserve(imgElement);
                    }
                });
            }
        
            lazyLoadImage($imgElement) {
                const src = $imgElement.attr('data-src');
        
                if (src && (src.startsWith('data:') || src.startsWith('http://') || src.startsWith('https://'))) {
                    $imgElement.parent().addClass('loaded');
                    return Promise.resolve();
                }
        
                return $.ajax({
                    url: src,
                    xhrFields: {
                        responseType: 'blob'
                    },
                    success: (blob) => {
                        $imgElement.attr('src', URL.createObjectURL(blob));
                        this.setImageDimensions($imgElement, src); // Call the function to set dimensions
                        $imgElement.parent().addClass('loaded');
                    },
                    error: () => console.error(`Failed to load image: ${src}`)
                });
            }
        
            setImageDimensions($imgElement, src) {
                let img = new Image();
                img.onload = function() {
                    $imgElement.attr('width', this.width);
                    $imgElement.attr('height', this.height);
                }
                img.src = src;
            }
        
            imageLoadPromise($img) {
                return new Promise((resolve, reject) => {
                    $img.on('load', () => resolve());
                    $img.on('error', () => reject(new Error(`Failed to load image: ${$img.src}`)));
                });
            }
        
            setupModalImage($img) {
                $img.on('click', () => {
                    const src = $img.attr('src');
                    const $modal = $(
                        `<div class="modal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                    <img class="modal-img img-fluid inherit" src="${src}" ondragstart="return false;">
                                    <a class="download-btn" href="${src}" download>${this.downloadMSN}</a>
                                    </div>
                                </div>
                            </div>`
                    );
        
                    $modal.appendTo('body').show();
                    $('body').css('overflow', 'hidden');
        
                    $modal.on('click', () => {
                        $modal.hide().remove();
                        $('body').css('overflow', 'visible');
                    });
                });
            }
        
            getDownloadMSN() {
                switch (window.location.href.split("?")[0]) {
                    case 'https://insane-bh.space':
                        return 'Download';
                    case 'https://insane-bh.space/es':
                        return 'Descarga';
                    case 'https://insane-bh.space/ja':
                        return 'ダウンロード';
                    case 'https://insane-bh.space/pt':
                        return 'Baixar';
                    case 'https://insane-bh.space/fr':
                        return 'Télécharger';
                    case 'https://insane-bh.space/de':
                        return 'Herunterladen';
                    case 'https://insane-bh.space/it':
                        return 'Scarica';
                    case 'https://insane-bh.space/ru':
                        return 'Скачать';
                    case 'https://insane-bh.space/cn':
                        return '下载';
                    case 'https://insane-bh.space/kr':
                        return '다운로드';
                    default:
                        return 'Download';
                }                
            }
        }
        
        const lazyImageLoader = new LazyImageLoader();
        const imagePromises = lazyImageLoader.loadImages();
        
        Promise.all(imagePromises)
            .then(() => console.log('All images loaded successfully'))
            .catch(error => console.error('Failed to load images:', error));        